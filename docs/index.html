<!DOCTYPE html>
<html lang="en">

<head>

  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <title>Solidity : Bikram Samvat Datetime Library</title>
	<!-- The generated javascript and app.js will be substituted in below -->
	
<script type="text/javascript">
/* Autogenerated - do not fiddle */
            if(typeof(Contracts)==="undefined") var Contracts={};
            (function(module, Contracts) {
                var data={
                    address: "0x7ffa4942bfc4b25f9bfe56e21110d9df45c301f4",
                    network: "rinkeby",
                    endpoint: "https://rinkeby.infura.io/",
                    abi: [
    {
        "constant": false,
        "inputs": [
            {
                "name": "_year",
                "type": "uint256"
            },
            {
                "name": "_months",
                "type": "int8[12]"
            }
        ],
        "name": "devSetBS",
        "outputs": [
            {
                "name": "",
                "type": "bool"
            }
        ],
        "payable": false,
        "stateMutability": "nonpayable",
        "type": "function"
    },
    {
        "constant": true,
        "inputs": [
            {
                "name": "_year",
                "type": "uint256"
            },
            {
                "name": "_month",
                "type": "uint8"
            },
            {
                "name": "_date",
                "type": "uint8"
            }
        ],
        "name": "BS2TS",
        "outputs": [
            {
                "name": "year",
                "type": "uint256"
            },
            {
                "name": "month",
                "type": "uint8"
            },
            {
                "name": "date",
                "type": "uint8"
            },
            {
                "name": "hour",
                "type": "uint8"
            },
            {
                "name": "min",
                "type": "uint8"
            },
            {
                "name": "sec",
                "type": "uint8"
            },
            {
                "name": "day",
                "type": "uint8"
            },
            {
                "name": "timestamp",
                "type": "uint256"
            }
        ],
        "payable": false,
        "stateMutability": "view",
        "type": "function"
    },
    {
        "constant": true,
        "inputs": [],
        "name": "maxBSYear",
        "outputs": [
            {
                "name": "",
                "type": "uint256"
            }
        ],
        "payable": false,
        "stateMutability": "view",
        "type": "function"
    },
    {
        "constant": true,
        "inputs": [],
        "name": "nowBS",
        "outputs": [
            {
                "name": "year",
                "type": "uint256"
            },
            {
                "name": "month",
                "type": "uint8"
            },
            {
                "name": "date",
                "type": "uint8"
            },
            {
                "name": "hour",
                "type": "uint8"
            },
            {
                "name": "min",
                "type": "uint8"
            },
            {
                "name": "sec",
                "type": "uint8"
            },
            {
                "name": "day",
                "type": "uint8"
            },
            {
                "name": "timestamp",
                "type": "uint256"
            }
        ],
        "payable": false,
        "stateMutability": "view",
        "type": "function"
    },
    {
        "constant": true,
        "inputs": [
            {
                "name": "_year",
                "type": "uint256"
            },
            {
                "name": "_month",
                "type": "uint8"
            },
            {
                "name": "_date",
                "type": "uint8"
            },
            {
                "name": "_hour",
                "type": "uint8"
            },
            {
                "name": "_min",
                "type": "uint8"
            },
            {
                "name": "_sec",
                "type": "uint8"
            }
        ],
        "name": "NST2TS",
        "outputs": [
            {
                "name": "year",
                "type": "uint256"
            },
            {
                "name": "month",
                "type": "uint8"
            },
            {
                "name": "date",
                "type": "uint8"
            },
            {
                "name": "hour",
                "type": "uint8"
            },
            {
                "name": "min",
                "type": "uint8"
            },
            {
                "name": "sec",
                "type": "uint8"
            },
            {
                "name": "day",
                "type": "uint8"
            },
            {
                "name": "timestamp",
                "type": "uint256"
            }
        ],
        "payable": false,
        "stateMutability": "view",
        "type": "function"
    },
    {
        "constant": true,
        "inputs": [
            {
                "name": "_year",
                "type": "uint256"
            },
            {
                "name": "_month",
                "type": "uint8"
            }
        ],
        "name": "getDaysInMonth",
        "outputs": [
            {
                "name": "",
                "type": "uint8"
            }
        ],
        "payable": false,
        "stateMutability": "view",
        "type": "function"
    },
    {
        "constant": true,
        "inputs": [],
        "name": "dev",
        "outputs": [
            {
                "name": "",
                "type": "address"
            }
        ],
        "payable": false,
        "stateMutability": "view",
        "type": "function"
    },
    {
        "constant": false,
        "inputs": [],
        "name": "killSwitch",
        "outputs": [],
        "payable": false,
        "stateMutability": "nonpayable",
        "type": "function"
    },
    {
        "constant": true,
        "inputs": [
            {
                "name": "_year",
                "type": "uint256"
            }
        ],
        "name": "isLeapYear",
        "outputs": [
            {
                "name": "",
                "type": "bool"
            }
        ],
        "payable": false,
        "stateMutability": "view",
        "type": "function"
    },
    {
        "constant": true,
        "inputs": [
            {
                "name": "_timestamp",
                "type": "uint256"
            }
        ],
        "name": "TS2BS",
        "outputs": [
            {
                "name": "year",
                "type": "uint256"
            },
            {
                "name": "month",
                "type": "uint8"
            },
            {
                "name": "date",
                "type": "uint8"
            },
            {
                "name": "hour",
                "type": "uint8"
            },
            {
                "name": "min",
                "type": "uint8"
            },
            {
                "name": "sec",
                "type": "uint8"
            },
            {
                "name": "day",
                "type": "uint8"
            },
            {
                "name": "timestamp",
                "type": "uint256"
            }
        ],
        "payable": false,
        "stateMutability": "view",
        "type": "function"
    },
    {
        "inputs": [],
        "payable": false,
        "stateMutability": "nonpayable",
        "type": "constructor"
    },
    {
        "payable": true,
        "stateMutability": "payable",
        "type": "fallback"
    }
]
            };
            Contracts["BikramSamvat"]=data;
            module.exports=data;
            })((typeof(module)==="undefined"?{}:module), Contracts);
            
let DAYS = ['आईतबार', 'सोमबार', 'मंगलबार', 'बुधबार', 'बिहीबार', 'शुक्रबार', 'शनिबार']
let MONTHS = ['बैशाख', 'जेष्ठ', 'अषाढ', 'श्रावण', 'भदौ', 'असोज', 'कार्तिक', 'मंगसिर', 'पौष', 'माघ', 'फाल्गुन', 'चैत्र']
let NENum = ['०', '१', '२', '३', '४', '५', '६', '७', '८', '९']
let MM = ['JAN', 'FEB', 'MAR', 'APR', 'MAY', 'JUN', 'JUL', 'AUG', 'SEP', 'OCT', 'NOV', 'DEC']
let _mx
let bida = 'rgba(255, 0,0, 0.51)'
let rain = ["#9400D3", "#4B0082", "#0000FF", "#00FF00", "#FFFF00", "#FF7F00", "#FF0000"]
const Cal = {

    minYear: 2027,
    maxYear: 2090,
    isLeapAD: (Y) => {
        return (Y % 100 === 0) ? (Y % 400 === 0) ? true : false : (Y % 4 === 0) ? true : false
    },
    changeMax: (ele, max) => {
        let _e = document.getElementById(ele)
        _e.setAttribute('max', max)
    },
    setMonth: () => {
        Cal.clearTable()
        let y = document.getElementById('selectYear').value
        let m = document.getElementById('selectMonth').value
        App.BS.methods.BS2TS(y, m, 1).call()
            .then((miti) => {
                App.BS.methods.getDaysInMonth(y, m).call().then((d2) => {
                    let d = 0
                    let r = (miti.day)
                    let _m
                    for (let i = 0; i < miti.day; i++) {
                        _m = document.getElementById(`date_0_${i}`)
                        _m.innerHTML = ''
                        _m.style.backgroundColor = '#725BA4'
                    }
                    let ts = miti.timestamp * 1
                    _mx = ''
                    for (let i = 0; i < d2; i++) {
                        if (r > 6) {
                            r = 0
                            d++
                        }
                        if (d > 4) {
                            d = 0
                            r = 0
                        }
                        _m = document.getElementById(`date_${d}_${r}`)
                        _m.innerHTML = ''
                        if (i < 9) {
                            _m.innerHTML += '&nbsp;'
                        }
                        _m.innerHTML += Cal.neNumber((i) + 1)
                        if (i < 9) {
                            _m.innerHTML += '&nbsp;'
                        }
                        _m.innerHTML += `&nbsp;<sub>${Cal.engDate(ts)}</sub>`
                        _m.style.backgroundColor = 'rgba(30, 30, 30, 0.88)'
                        _m.setAttribute('title', Cal.formatTitle(ts, y, m, i + 1))

                        r++
                        ts += 86400
                    }
                    if (d == 4) {
                        for (; r < 7; r++) {
                            let _m = document.getElementById(`date_${d}_${r}`)
                            _m.innerHTML = ''
                            _m.style.backgroundColor = '#725BA4'
                        }
                    }

                    for (let k = 0; k < 5; k++) {
                        _m = document.getElementById(`date_${k}_6`)
                        if (_m.innerHTML !== '') {
                            _m.style.backgroundColor = bida
                        }
                    }
                }).catch(App.onError)
            }).catch(App.onError)
    },
    formatTitle: (ts, yy, mm, dd) => {
        let d = new Date(ts * 1000)
        return `BS ${yy}/${mm}/${dd} || ${d.toLocaleDateString()} AD`
    },
    engDate: (ts) => {
        let d = new Date(ts * 1000)
        if (_mx !== d.getMonth()) {
            _mx = d.getMonth()
            return `${d.getDate()} <span class="tbrl">${MM[_mx]}</span>`
        }
        return d.getDate()
    },
    newInput: (id, x, min, max, val) => {
        let inx = document.createElement('input')
        inx.setAttribute('type', 'number')
        inx.setAttribute('id', id + '_' + x)
        inx.setAttribute('max', max)
        inx.setAttribute('min', min)
        inx.setAttribute('value', val)
        let _e2 = document.getElementById(id)
        _e2.innerHTML += `<b class="label">   ${x}  </b>`
        _e2.appendChild(inx)
    },
    init: () => {
        let _monthSelect = document.getElementById('selectMonth')
        let _yearSelect = document.getElementById('selectYear')

        MONTHS.forEach((month, index) => {
            let opt = document.createElement('option')
            opt.text = month;
            opt.value = index + 1
            _monthSelect.add(opt)
        })

        for (let i = 2027; i < 2091; i++) {
            let opt = document.createElement('option')
            opt.text = Cal.neNumber(i)
            opt.value = i
            _yearSelect.add(opt, i)
        }

        for (let i = 0; i < 5; i++) {
            let sat = document.getElementById('date_' + i + '_6')
            sat.style.background = bida
        }

        _monthSelect.addEventListener('change', Cal.setMonth)
        _yearSelect.addEventListener('change', Cal.setMonth)

        //Cal.newInput('ts2bs', 'TS', 8878500, 2028478500, 1231006505)
        Cal.newInput('ts2bs', 'Y', 1981, 2033, 2009)
        Cal.newInput('ts2bs', 'M', 1, 12, 1)
        Cal.newInput('ts2bs', 'D', 1, 31, 4)
        Cal.newInput('bs2ts', 'Y', 2027, 2090, 2065)
        Cal.newInput('bs2ts', 'M', 1, 12, 9)
        Cal.newInput('bs2ts', 'D', 1, 32, 20)
    },
    neNumber: (num) => {
        let out = ''
        num = num.toString().split('')
        for (var i = 0; i < num.length; i++) {
            out += NENum[num[i]]
        }
        return out
    },
    onReady: () => {
        Cal.createTable()
        Cal.init()
        let monthSelect = document.getElementById('selectMonth')
        let yearSelect = document.getElementById('selectYear')
        let prevMonth = document.getElementById('prevMonth')
        prevMonth.addEventListener("click", () => {
            _mx = ''
            if (monthSelect.value == 1) {
                monthSelect.value = 12
                if (yearSelect.value < 2028) {
                    yearSelect.value = 2090
                } else {
                    yearSelect.value--
                }
            } else {
                monthSelect.value--
            }
            Cal.setMonth()
        })
        let prevYear = document.getElementById('prevYear')
        prevYear.addEventListener("click", () => {
            if (yearSelect.value < 2028) {
                yearSelect.value = 2090
            } else {
                yearSelect.value--
            }
            Cal.setMonth()
        })
        let nextMonth = document.getElementById('nextMonth')
        nextMonth.addEventListener("click", () => {
            _mx = ''
            if (monthSelect.value == 12) {
                monthSelect.value = 1
                if (yearSelect.value > 2089) {
                    yearSelect.value = 2027
                } else {
                    yearSelect.value++
                }
            } else {
                monthSelect.value++
            }
            Cal.setMonth()
        })
        let nextYear = document.getElementById('nextYear')
        nextYear.addEventListener("click", () => {
            if (yearSelect.value > 2089) {
                yearSelect.value = 2027
            } else {
                yearSelect.value++
            }
            Cal.setMonth()
        })
        Cal.thisMonth()
    },
    thisMonth: () => {
        let monthSelect = document.getElementById('selectMonth')
        let yearSelect = document.getElementById('selectYear')
        let d = new Date()
        App.BS.methods.TS2BS(Math.floor(d.getTime() / 1000)).call()
            .then((data) => {
                if (monthSelect.value != data.month || yearSelect.value != data.year) {
                    monthSelect.value = data.month
                    yearSelect.value = data.year
                    Cal.setMonth()
                }
            }).catch(App.onError)
    },
    clearTable: () => {
        for (let i = 0; i < 5; i++) {
            for (let j = 0; j < 7; j++) {
                let td = document.getElementById('date_' + i + '_' + j)
                td.innerHTML = ""
                let x = rain[Math.floor((Math.random() * 42) % 6)]
                td.style.backgroundColor = x
            }
        }
    },
    createTable: () => {

        let container = document.getElementById('cal')
        let table = document.createElement('table')
        let thead = document.createElement('thead')
        let tbody = document.createElement('tbody')
        table.setAttribute('border', '1')

        let tr = document.createElement('tr')

        DAYS.forEach((day) => {
            let td = document.createElement('td')
            td.innerHTML = day
            if (day === 'शनिबार') {
                td.style.background = bida
            }
            tr.appendChild(td)
        })

        thead.appendChild(tr)
        table.appendChild(thead)

        for (let i = 0; i < 5; i++) {
            let tr = document.createElement('tr')
            tr.innerHTML = ''
            for (let j = 0; j < 7; j++) {
                let td = document.createElement('td')
                td.setAttribute('id', 'date_' + i + '_' + j)
                let x = rain[Math.floor((Math.random() * 9000) % 6)]
                td.style.backgroundColor = x
                tr.appendChild(td)
            }
            tbody.appendChild(tr)
        }

        table.appendChild(tbody)
        container.appendChild(table)
    }
}
window.Cal = Cal

let BS, accounts, account, isMetaMask, prevHash, blockNumber
//['Baishakh','Jestha','Ashad','Shrawan','Bhadau','Ashoj','Kartik','Mangsir','Poush','Magh','Falgun','Chaitra']

let _Y, _M, _D, _h, _m, _s, _ts
const App = {
    start: (contract) => {
        //_h = document.getElementById('_hour')
        //_m = document.getElementById('_min')
        //_s = document.getElementById('_sec')
        _ts = document.getElementById('_timestamp')
        App.BS = new web3.eth.Contract(contract.abi, contract.address)
        App.BS.options.from = account
        Cal.onReady()
        console.log(1, App.BS)
        web3.eth.getBlock(0).then(block => {
            App.checkSetup()
            App.update()
            //if (result.hash == '0x6341fd3daf94b748c72ced5a5b26028f2474f5f00d824504e4fa37a75767e177') {
        }).catch(App.onError)
    },
    setStatus: (e) => {
        document.getElementById('status').innerHTML = e
    },
    onError: (e) => {
        console.error(e)
        App.setStatus(e)
    },
    setResult: (message) => {
        let res = document.getElementById('result')
        res.innerHTML = message
    },
    bs2ts: () => {
        App.setStatus('Retriving data from blockchain. (please wait)')
        _Y = document.getElementById('bs2ts_Y')
        _M = document.getElementById('bs2ts_M')
        _D = document.getElementById('bs2ts_D')
        console.log(_Y.value, _M.value, _D.value)
        App.BS.methods.BS2TS(_Y.value, _M.value, _D.value).call()
            .then((data) => {
                App.setStatus('Converted!!')
                console.log(data.timestamp)
                App.setResult(Cal.formatTitle(data.timestamp, _Y.value, _M.value, _D.value))
            }).catch(App.onError)
    },
    ts2bs: function () {
        App.setStatus('Retriving data from blockchain. (please wait)')
        _Y = document.getElementById('ts2bs_Y').value
        _M = document.getElementById('ts2bs_M').value
        _D = document.getElementById('ts2bs_D').value
        let d = new Date(`${_Y}/${_M}/${_D} 00:00:00 GMT+545`)
        App.BS.methods.TS2BS(Math.floor(d.getTime() / 1000)).call()
            .then((data) => {
                App.setStatus('Converted!!')
                App.setResult(Cal.formatTitle(data.timestamp, data.year, data.month, data.date))
            }).catch(App.onError)
    },
    nowBS: (block) => {
        App.BS.methods.nowBS().call().then((data) => {
            console.log('NOW', data)
            document.getElementById('status').innerHTML = `मिती  : ${Cal.neNumber(data.year)} ${MONTHS[data.month - 1]} ${Cal.neNumber(data.date)} गते, ${DAYS[data.day]} &nbsp;&nbsp; समय : ${App.checkNum(data[3])} : ${App.checkNum(data[4])} : ${App.checkNum(data[5])} || ${data[7]}`;
        }).catch(App.onError)
    },
    checkNum: (num) => {
        return num < 9 ? Cal.neNumber('0' + num) : Cal.neNumber(num)
    },
    update: () => {
        web3.eth.subscribe('newBlockHeaders', (err, block) => {
            if (err) {
                App.onError(err)
                App.nowBS()
                setInterval(App.nowBS, 7777)
            } else {
                App.nowBS()
            }
        })
    },
    checkSetup: () => {
        App.BS.methods.maxBSYear().call().then((max) => {
            if (max < 2090) {
                App.BS.methods.dev().call().then((dev) => {
                    if (dev === account) {
                        App.setStatus(`Dev Setup <button href="#" onclick="App.setup(${max})">${max}++</button`)
                    }
                    console.log('dev', dev, account)
                }).catch(App.onError)
            }
        }).catch(App.onError)
    },
    setup: (max) => {
        let data = [
            [2029, 1, 1, 2, 1, 2, 0, 0, -1, 0, -1, 0, 0],
            [2030, 1, 2, 1, 2, 1, 0, 0, 0, -1, -1, 0, 1],
            [2031, 0, 2, 1, 2, 1, 0, 0, 0, -1, 0, -1, 1],
            [2032, 1, 1, 2, 1, 1, 1, 0, -1, 0, -1, 0, 0],
            [2033, 1, 1, 2, 2, 1, 0, 0, -1, 0, -1, 0, 0],
            [2034, 1, 2, 1, 2, 1, 0, 0, 0, -1, -1, 0, 1],
            [2035, 0, 2, 1, 2, 1, 1, -1, 0, 0, -1, -1, 1],
            [2036, 1, 1, 2, 1, 1, 1, 0, -1, 0, -1, 0, 0],
            [2037, 1, 1, 2, 2, 1, 0, 0, -1, 0, -1, 0, 0],
            [2038, 1, 2, 1, 2, 1, 0, 0, 0, -1, -1, 0, 1],
            [2039, 1, 1, 1, 2, 1, 1, -1, 0, 0, -1, 0, 0],
            [2040, 1, 1, 2, 1, 1, 1, 0, -1, 0, -1, 0, 0],
            [2041, 1, 1, 2, 2, 1, 0, 0, -1, 0, -1, 0, 0],
            [2042, 1, 2, 1, 2, 1, 0, 0, 0, -1, -1, 0, 1],
            [2043, 1, 1, 1, 2, 1, 1, -1, 0, 0, -1, 0, 0],
            [2044, 1, 1, 2, 1, 1, 1, 0, -1, 0, -1, 0, 0],
            [2045, 1, 2, 1, 2, 1, 0, 0, -1, 0, -1, 0, 0],
            [2046, 1, 2, 1, 2, 1, 0, 0, 0, -1, -1, 0, 1],
            [2047, 1, 1, 1, 2, 1, 1, 0, -1, 0, -1, 0, 0],
            [2048, 1, 1, 2, 1, 1, 1, 0, -1, 0, -1, 0, 0],
            [2049, 1, 2, 1, 2, 1, 0, 0, 0, -1, -1, 0, 0],
            [2050, 1, 2, 1, 2, 1, 0, 0, 0, -1, 0, -1, 1],
            [2051, 1, 1, 1, 2, 1, 1, 0, -1, 0, -1, 0, 0],
            [2052, 1, 1, 2, 1, 1, 1, 0, -1, 0, -1, 0, 0],
            [2053, 1, 2, 1, 2, 1, 0, 0, 0, -1, -1, 0, 0],
            [2054, 1, 2, 1, 2, 1, 0, 0, 0, -1, 0, -1, 1],
            [2055, 1, 1, 2, 1, 1, 1, 0, -1, 0, -1, 0, 0],
            [2056, 1, 1, 2, 1, 2, 0, 0, -1, 0, -1, 0, 0],
            [2057, 1, 2, 1, 2, 1, 0, 0, 0, -1, -1, 0, 1],
            [2058, 0, 2, 1, 2, 1, 0, 0, 0, -1, 0, -1, 1],
            [2059, 1, 1, 2, 1, 1, 1, 0, -1, 0, -1, 0, 0],
            [2060, 1, 1, 2, 2, 1, 0, 0, -1, 0, -1, 0, 0],
            [2061, 1, 2, 1, 2, 1, 0, 0, 0, -1, -1, 0, 1],
            [2062, 0, 2, 1, 2, 1, 1, -1, 0, -1, 0, -1, 1],
            [2063, 1, 1, 2, 1, 1, 1, 0, -1, 0, -1, 0, 0],
            [2064, 1, 1, 2, 2, 1, 0, 0, -1, 0, -1, 0, 0],
            [2065, 1, 2, 1, 2, 1, 0, 0, 0, -1, -1, 0, 1],
            [2066, 1, 1, 1, 2, 1, 1, -1, 0, 0, -1, -1, 1],
            [2067, 1, 1, 2, 1, 1, 1, 0, -1, 0, -1, 0, 0],
            [2068, 1, 1, 2, 2, 1, 0, 0, -1, 0, -1, 0, 0],
            [2069, 1, 2, 1, 2, 1, 0, 0, 0, -1, -1, 0, 1],
            [2070, 1, 1, 1, 2, 1, 1, -1, 0, 0, -1, 0, 0],
            [2071, 1, 1, 2, 1, 1, 1, 0, -1, 0, -1, 0, 0],
            [2072, 1, 2, 1, 2, 1, 0, 0, -1, 0, -1, 0, 0],
            [2073, 1, 2, 1, 2, 1, 0, 0, 0, -1, -1, 0, 1],
            [2074, 1, 1, 1, 2, 1, 1, 0, -1, 0, -1, 0, 0],
            [2075, 1, 1, 2, 1, 1, 1, 0, -1, 0, -1, 0, 0],
            [2076, 1, 2, 1, 2, 1, 0, 0, 0, -1, -1, 0, 0],
            [2077, 1, 2, 1, 2, 1, 0, 0, 0, -1, 0, -1, 1],
            [2078, 1, 1, 1, 2, 1, 1, 0, -1, 0, -1, 0, 0],
            [2079, 1, 1, 2, 1, 1, 1, 0, -1, 0, -1, 0, 0],
            [2080, 1, 2, 1, 2, 1, 0, 0, 0, -1, -1, 0, 0],
            [2081, 1, 1, 2, 2, 1, 0, 0, 0, -1, 0, 0, 0],
            [2082, 0, 2, 1, 2, 1, 0, 0, 0, -1, 0, 0, 0],
            [2083, 1, 1, 2, 1, 1, 0, 0, 0, -1, 0, 0, 0],
            [2084, 1, 1, 2, 1, 1, 0, 0, 0, -1, 0, 0, 0],
            [2085, 1, 2, 1, 2, 0, 1, 0, 0, -1, 0, 0, 0],
            [2086, 0, 2, 1, 2, 1, 0, 0, 0, -1, 0, 0, 0],
            [2087, 1, 1, 2, 1, 1, 1, 0, 0, -1, 0, 0, 0],
            [2088, 0, 1, 2, 2, 0, 1, 0, 0, -1, 0, 0, 0],
            [2089, 0, 2, 1, 2, 1, 0, 0, 0, -1, 0, 0, 0],
            [2090, 0, 2, 1, 2, 1, 0, 0, 0, -1, 0, 0, 0]
        ]
        data.forEach((dat) => {
            if (dat[0] === max * 1 + 1) {
                let y = dat.shift()
                console.log(max, y, dat)
                App.BS.methods.devSetBS(y, dat).estimateGas({ from: account }).then((txGas) => {
                    console.log(txGas)
                    App.BS.methods.devSetBS(y, dat).send({ from: account, gas: txGas }).then((tx) => {
                        console.log(tx)
                        App.checkSetup()
                    }).catch(App.onError)
                }).catch(App.onError)
            }
        })
    }
}
window.App = App
window.addEventListener('load', async () => {
    try {
        if (window.ethereum) {
            console.log('MetaMask')
            web3 = new Web3(ethereum)
            await ethereum.enable()
            isMetaMask = true
        } else if (window.web3) {
            console.log('current')
            web3 = new Web3(web3.currentProvider)
        } else {
            console.log('infura')
            web3 = new Web3(new Web3.providers.WebsocketProvider('wss://rinkeby.infura.io/ws/v3/5070fb8309944f18aa07840da75a9da9'))
        }
        accounts = await web3.eth.getAccounts()
        account = accounts[0]
        App.start(Contracts['BikramSamvat'])
    } catch (error) {
        console.log('Web3 ', error)
    }
})
</script>



	<!-- The app.css contents will be substituted in below -->
	<style type="text/css">
sub{
    font-size: 23px;
    color: #f8e736;
}
.tbrl{
    writing-mode: tb-rl;
    -webkit-transform:rotate(180deg);
    -moz-transform:rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform:rotate(180deg);
    transform: rotate(180deg);
}
body {
    background-color: #9400D3;
    color: #FCE8DF;
    font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
    text-align: center;
}
h1{
    font-size: 3em;
}
table{
    width:100%;  
    table-layout: fixed;
    border: #fff;
}
td{
    width:14%;
}
thead > tr {
    font-size: 1.7em;
    font-weight: bold;
}
tbody > #today{
    background-color: #FCE8DF;
}
.label {
    font-size: 2em;
    font-weight: bold;
}
tbody > tr {
    font-size:2em;
    height: 100px;
}
#cal{
    height:100%;
    clear: both;
}
#status {
    font-size: 2em;
    color: #FCE8DF;
    height: 60px;
    background-color: #4B0082;
    width: 100%;
}
#result {
    font-size: 2em;
    color: #FCE8DF;
}
select {
    width:100px;
    height: 60px;
    font-size: 1.3em;
    font-weight: bold;
    text-indent: 15px; 
}

input[type=number] { 
    text-align:center;
}
input {
    width:100px;
    height: 54px;
    font-size: 1.3em;
    font-weight: bold;
}
option{
    text-align: center;
}
button {
    vertical-align:bottom;
    text-align: center;
    width:120px;
    height: 60px;
    font-size: 1.2em;
}

</style>

</head>

<body><a href="https://github.com/nepal-blockchain/bikram-samvat"><img style="position: fixed; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"></a>

	<h1>
		Bikram Samvat Datetime Library in Solidity
	</h1>
	<div style="float:left;">
		<button href="#" id="prevYear"> Prev Year </button>
		<button href="#" id="prevMonth"> Prev Month </button>
	</div>

	<div style="float:right;">
		<button href="#" id="nextMonth"> Next Month </button>
		<button href="#" id="nextYear"> Next Year </button>
	</div>

	<div>
		<select id="selectYear"></select>
		<button href="#" style="vertical-align:bottom;" onclick="Cal.thisMonth();"> This Month </button>
		<select id="selectMonth"></select>
	</div>
	<div id="cal">

	</div>
	<div id="status">

	</div>
	<div style="float:left; width:50%;background-color:#4B0082;">
		<h1>BS to AD</h1>
		<span id="bs2ts">

            </span>
		</br>
		</br>
		<button href="#" style="margin-left: 4%;" onclick="App.bs2ts();">CONVERT</button>
	</div>
	<div style="float:right; width:50%; background-color:#4B0082;">
		<h1>AD to BS</h1>
		<span id="ts2bs">

            </span>
		</br>
		</br>
		<button style="margin-left: 4%;" href="#" onclick="App.ts2bs();">CONVERT</button>
	</div>


	<div style="clear:both; width:100%;background-color:#4B0082;" id="result">0
	</div>
	<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/ethereum/web3.js@1.0.0-beta.36/dist/web3.min.js"></script>
</body>

</html>
